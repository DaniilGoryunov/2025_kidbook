# Отчет по лабораторной работе

## Состав команды

| ФИО            | Группа      | Что делал                | Оценка |
| -------------- | ----------- | ------------------------ | ------ |
| Медведев Н.А.  | М8О-301Б-22 | Скрипт генерации LLM по API, онтология, генерация текстов |        |
| Медведев Е.А.  | М8О-301Б-22 | Генерация текстов, составление SPARQL запросов                       |        |
| Чапалда М.О.   | М8О-301Б-22 | Генерация текстов, генерация картинок, отчет                        |        |
| Соловьева М.В. | М8О-301Б-22 | Генерация текстов, составление картинок (описание понятий), отчет         |        |
| Сарайкин Н.С.  | М8О-306Б-22 | Создание графа (визуализация онтологии), скрипт создания перекрестных ссылок, парсинг данных в JSON |        |

## Концептуализация предметной области
В результате составления SPARQL-запросов мы не смогли найти нужную нам информацию,связанную с личными качествами поэтому прибегли к составлению онтологии путем использования LLM API.
Далее визуализировали ее с помощью графа. После построения графа онтологии мы занялись генерацией текстов.

### Онтология 

#### Основные классы:

1. **Личное качество**:
   - Подклассы: Положительные, Отрицательные, Нейтральные.
2. **Категория качества**:
   - Эмоциональные, Интеллектуальные, Социальные, Моральные.
3. **Контекст проявления**:
   - Семья, Работа, Дружба.
1. **Личное качество**:
   - Подклассы: Положительные, Отрицательные, Нейтральные.
2. **Категория качества**:
   - Эмоциональные, Интеллектуальные, Социальные, Моральные.
3. **Контекст проявления**:
   - Семья, Работа, Дружба.

#### Понятия (15 штук):

1. Доброта (Положительное, Моральное)
2. Смелость (Положительное, Эмоциональное)
3. Честность (Положительное, Моральное)
4. Щедрость (Положительное, Социальное)
5. Эмпатия (Положительное, Эмоциональное)
6. Лень (Отрицательное, Социальное)
7. Лицемерие (Отрицательное, Моральное)
8. Жадность (Отрицательное, Социальное)
9. Вспыльчивость (Отрицательное, Эмоциональное)
10. Высокомерие (Отрицательное, Социальное)
11. Сдержанность (Нейтральное, Эмоциональное)
12. Любопытство (Нейтральное, Интеллектуальное)
13. Замкнутость (Нейтральное, Социальное)
14. Терпение (Положительное, Эмоциональное)
15. Ответственность (Положительное, Моральное)

#### Связи:

- **Иерархические**: "Доброта" is-a "Положительное качество".
- **Горизонтальные**:
  - "Эмпатия" усиливает "Доброту".
  - "Честность" противоположна "Лицемерию".
  - "Щедрость" проявляется в "Дружбе".
  - "Лень" ослабляет "Ответственность".
- **Иерархические**: "Доброта" is-a "Положительное качество".
- **Горизонтальные**:
  - "Эмпатия" усиливает "Доброту".
  - "Честность" противоположна "Лицемерию".
  - "Щедрость" проявляется в "Дружбе".
  - "Лень" ослабляет "Ответственность".

### Визуализация онтологии

Для визуализации онтологии был использован **Mermaid.js**, позволяющий создавать графические представления в Markdown. Граф отображает иерархические связи между понятиями, а также горизонтальные взаимосвязи. 
![Онтология](data/visual.mmd)


# Генерация характеристик

Для генерации текстов использовался API **GigaChat**. Использовались заранее подготовленные промпты, ориентированные на объяснение понятий детям 10 лет.

**[Промпт генерации текста](/WORK/life/personal_qualities/data/characteristic_prompt.md)**:  
*Содержит инструкции для LLM: создать красочную, эмоционально насыщенную статью с метафорами, примерами из жизни и перекрестными упоминаниями других качеств.*

**Код:**  
Использовалась библиотека `langchain` с шаблоном запроса (`PromptTemplate`). Для каждого понятия из списка формировался markdown-файл:  
- Получение текста через `llm.chat(prompt)`
- Сохранение `.md` в директорию `KIDBOOK/life/personal_qualities`

### Перекрестные ссылки

После генерации текста, отдельный скрипт проходился по каждому файлу и автоматически подставлял markdown-ссылки на другие качества, если они упоминались. Использовался `pymorphy3` для лемматизации  

**Код:**  
Скрипт `add_links.py`  
- Проходится по каждому `.md`-файлу  
- Находит совпадения с другими понятиями  
- Подставляет `[Слово](Название.md)`, если это не текущее понятие  


### Генерация структуры и связей

Скрипт `concepts_to_json.py`:
- Сканирует `.md`-файлы
- Извлекает внутренние ссылки
- Формирует `concepts.json` с полным списком понятий и их связями

# Генерация изображений

Для генерации иллюстраций использовался **GPT с функцией image_gen** на основе заранее заданного визуального шаблона:  
- Мультяшный стиль  
- Цвета: красный, жёлтый, оранжевый  
- Атрибуты: огненные волосы, яркие глаза, пружинящие ножки и пр.  
- Каждый персонаж соответствует понятию и визуализирует его характер

**[Промпт генерации изображений](/WORK/life/personal_qualities/data/picture_prompt.md)**:  
*Включает инструкции по цветам, позам, деталям и эмоциям.*

Готов включить эти блоки прямо в отчет, если нужно.

## **Итоговые результаты**
- ✅ Создана онтология личных качеств (15 понятий + картинки)
- ✅ Визуализирован граф онтологии (Mermaid.js).
- ✅ Сгенерированы статьи с помощью LLM по API Gigachat (15 текстов).
- ✅ Реализована система перекрестных ссылок между понятиями скриптом с помощью pymorphy3.
- ✅ Необходимые данные для расширения парсятся скриптом в concepts.json

### **Выводы**
- В результате выполнения данной работы, мы провели концептуализация предметной области, составили онтологию, представили ее визуализацию на основе графа, сгенерировали на основе нее необходимые статьи для понятий, создали перекрестные ссылки между ними. 

**Возможные улучшения:**
- Внедрить автоматическое извлечение информации из WikiData с помощью SPARQL-запросов и качественная фильтрация их результатов.

- Улучшение качества картинок: использовать генеративные модели (Stable Diffusion, DALL·E).

- Гибкость онтологии: добавить возможность расширения с новыми качествами и категориями.
